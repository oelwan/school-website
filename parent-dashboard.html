<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Parent Dashboard - EduPortal</title>
    <link rel="stylesheet" href="css/style.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <header class="header">
        <div class="container">
            <div class="nav-brand">
                <i class="fas fa-graduation-cap"></i>
                <h1>EduPortal</h1>
            </div>
            <nav class="nav-menu">
                <a href="#dashboard" class="nav-link active">Dashboard</a>
                <a href="#children" class="nav-link">My Children</a>
                <a href="#communications" class="nav-link">Messages</a>
                <a href="#calendar" class="nav-link">Calendar</a>
                <div class="auth-buttons">
                    <span id="parentName" class="user-name"></span>
                    <button class="logout-btn" onclick="logout()">Logout</button>
                </div>
            </nav>
        </div>
    </header>

    <main class="dashboard">
        <div class="container">
            <!-- Dashboard Header -->
            <div class="dashboard-header">
                <div class="container">
                    <div class="dashboard-title">
                        <h2>Parent Dashboard</h2>
                        <div class="child-selector">
                            <label for="childSelect">Viewing:</label>
                            <select id="childSelect" onchange="switchChild()">
                                <option value="">All Children</option>
                                <!-- Options will be loaded dynamically -->
                            </select>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Quick Stats Cards -->
            <div class="dashboard-grid">
                <div class="dashboard-card">
                    <i class="fas fa-child card-icon"></i>
                    <h3>My Children</h3>
                    <p>Track all your children's academic progress</p>
                    <div class="stat-number" id="totalChildren">0</div>
                    <button class="btn btn-primary" onclick="showSection('children')">View Children</button>
                </div>
                
                <div class="dashboard-card">
                    <i class="fas fa-exclamation-triangle card-icon"></i>
                    <h3>Urgent Items</h3>
                    <p>Overdue assignments and low grades</p>
                    <div class="stat-number" id="urgentItems">0</div>
                    <button class="btn btn-primary" onclick="showUrgentItems()">View Details</button>
                </div>
                
                <div class="dashboard-card">
                    <i class="fas fa-envelope card-icon"></i>
                    <h3>Messages</h3>
                    <p>Communication with teachers</p>
                    <div class="stat-number" id="unreadMessages">0</div>
                    <button class="btn btn-primary" onclick="showSection('communications')">View Messages</button>
                </div>
            </div>

            <!-- Children Section -->
            <section id="children" class="section">
                <h2 class="section-title">My Children</h2>
                <div id="childrenGrid" class="children-grid">
                    <!-- Children cards will be loaded dynamically -->
                </div>
            </section>

            <!-- Communications Section -->
            <section id="communications" class="section">
                <div class="section-header">
                    <h2 class="section-title">Messages & Communications</h2>
                    <button class="btn btn-primary" onclick="showComposeModal()">
                        <i class="fas fa-plus"></i> New Message
                    </button>
                </div>
                <div class="communications-container">
                    <div class="messages-list" id="messagesList">
                        <!-- Messages will be loaded dynamically -->
                    </div>
                </div>
            </section>

            <!-- Calendar Section -->
            <section id="calendar" class="section">
                <h2 class="section-title">Academic Calendar</h2>
                <div class="calendar-container">
                    <div class="calendar-filters">
                        <select id="calendarChildFilter" onchange="filterCalendar()">
                            <option value="">All Children</option>
                            <!-- Options will be loaded dynamically -->
                        </select>
                        <select id="calendarTypeFilter" onchange="filterCalendar()">
                            <option value="">All Events</option>
                            <option value="homework">Homework</option>
                            <option value="exam">Exams</option>
                            <option value="project">Projects</option>
                        </select>
                    </div>
                    <div class="calendar-events" id="calendarEvents">
                        <!-- Calendar events will be loaded dynamically -->
                    </div>
                </div>
            </section>
        </div>
    </main>

    <!-- Child Detail Modal -->
    <div id="childModal" class="modal">
        <div class="modal-content large-modal">
            <div class="modal-header">
                <h3 id="childModalTitle">Child Progress</h3>
                <span class="close" onclick="closeModal('childModal')">&times;</span>
            </div>
            <div class="modal-body">
                <div class="child-overview">
                    <div class="overview-stats">
                        <div class="stat-item">
                            <span class="stat-label">Overall GPA</span>
                            <span class="stat-number" id="childGPA">0.0</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">Courses</span>
                            <span class="stat-number" id="childCourses">0</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">Assignments</span>
                            <span class="stat-number" id="childAssignments">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="tabs">
                    <button class="tab-button active" onclick="showTab('grades')">Grades</button>
                    <button class="tab-button" onclick="showTab('assignments')">Assignments</button>
                    <button class="tab-button" onclick="showTab('attendance')">Attendance</button>
                </div>
                
                <div id="gradesTab" class="tab-content active">
                    <h4>Course Grades</h4>
                    <div class="table-container">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Course</th>
                                    <th>Teacher</th>
                                    <th>Current Grade</th>
                                    <th>Assignments</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="childGradesTable">
                                <!-- Child grades will be loaded dynamically -->
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <div id="assignmentsTab" class="tab-content">
                    <h4>Recent Assignments</h4>
                    <div class="table-container">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Assignment</th>
                                    <th>Course</th>
                                    <th>Due Date</th>
                                    <th>Status</th>
                                    <th>Grade</th>
                                </tr>
                            </thead>
                            <tbody id="childAssignmentsTable">
                                <!-- Child assignments will be loaded dynamically -->
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <div id="attendanceTab" class="tab-content">
                    <h4>Attendance Record</h4>
                    <p>Attendance tracking feature would be implemented here.</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Compose Message Modal -->
    <div id="composeModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Send Message to Teacher</h3>
                <span class="close" onclick="closeModal('composeModal')">&times;</span>
            </div>
            <div class="modal-body">
                <form id="composeForm">
                    <div class="form-group">
                        <label for="messageChild">Regarding Child</label>
                        <select id="messageChild" name="childId" required>
                            <option value="">Select Child</option>
                            <!-- Options will be loaded dynamically -->
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="messageTeacher">To Teacher</label>
                        <select id="messageTeacher" name="teacherId" required>
                            <option value="">Select Teacher</option>
                            <!-- Options will be loaded dynamically -->
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="messageSubject">Subject</label>
                        <input type="text" id="messageSubject" name="subject" required>
                    </div>
                    <div class="form-group">
                        <label for="messageContent">Message</label>
                        <textarea id="messageContent" name="content" rows="5" required placeholder="Type your message here..."></textarea>
                    </div>
                    <button type="submit" class="btn btn-primary btn-full">Send Message</button>
                </form>
            </div>
        </div>
    </div>

    <!-- Message Detail Modal -->
    <div id="messageModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="messageModalTitle">Message Details</h3>
                <span class="close" onclick="closeModal('messageModal')">&times;</span>
            </div>
            <div class="modal-body">
                <div class="message-info">
                    <div class="info-item">
                        <strong>From:</strong>
                        <span id="messageFrom"></span>
                    </div>
                    <div class="info-item">
                        <strong>To:</strong>
                        <span id="messageTo"></span>
                    </div>
                    <div class="info-item">
                        <strong>Date:</strong>
                        <span id="messageDate"></span>
                    </div>
                    <div class="info-item">
                        <strong>Regarding:</strong>
                        <span id="messageRegarding"></span>
                    </div>
                </div>
                <div class="message-content">
                    <h4>Message:</h4>
                    <p id="messageText"></p>
                </div>
                <div class="message-actions">
                    <button class="btn btn-primary" onclick="replyToMessage()">Reply</button>
                </div>
            </div>
        </div>
    </div>

    <script src="js/parent-dashboard.js"></script>
</body>
</html>
